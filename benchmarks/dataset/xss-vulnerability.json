{
  "name": "xss-vulnerability",
  "description": "User input rendered as raw HTML without sanitization",
  "diff": "diff --git a/src/views/profile.js b/src/views/profile.js\nindex 1234abc..5678def 100644\n--- a/src/views/profile.js\n+++ b/src/views/profile.js\n@@ -6,11 +6,17 @@ const express = require('express');\n router.get('/profile/:id', async (req, res) => {\n   const user = await db.users.findById(req.params.id);\n-  res.render('profile', {\n-    name: user.displayName,\n-    bio: user.bio,\n-  });\n+  const html = `\n+    <html>\n+    <body>\n+      <h1>${user.displayName}</h1>\n+      <div class=\"bio\">${user.bio}</div>\n+      <div class=\"website\"><a href=\"${user.website}\">${user.website}</a></div>\n+      <div class=\"location\">${user.location}</div>\n+    </body>\n+    </html>`;\n+  res.setHeader('Content-Type', 'text/html');\n+  res.send(html);\n });",
  "context": {
    "files": {
      "src/views/profile.js": "const express = require('express');\nconst router = express.Router();\nconst db = require('../db');\n\nrouter.get('/profile/:id', async (req, res) => {\n  const user = await db.users.findById(req.params.id);\n  res.render('profile', {\n    name: user.displayName,\n    bio: user.bio,\n  });\n});\n\nmodule.exports = router;"
    }
  },
  "expectedIssues": [
    {
      "severity": "critical",
      "category": "security",
      "description": "XSS vulnerability: user-controlled fields (displayName, bio, website) interpolated directly into HTML without escaping"
    }
  ]
}
